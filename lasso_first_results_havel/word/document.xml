<?xml version="1.0" encoding="UTF-8"?>
<w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"><w:body><w:p><w:pPr><w:pStyle w:val="Title" /></w:pPr><w:r><w:t xml:space="preserve">First</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">Lasso</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">experiments</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">Set.seed was set to 4 to make results reproducable</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">prerun this please: code_below is full gitcode from ’heiko_wolfgang_code_test.R&quot;</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">{</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  {</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">library</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(magrittr)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">library</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(dplyr)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">library</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(glmnet)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">library</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(purrr)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">library</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(tidyverse)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#?glmnet</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">library</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(coefplot) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#for extracing non 0 coef</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#install.packages(&quot;tidyverse&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">library</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(tidyverse)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">library</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(pROC)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">library</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fhpredict)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">library</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(tidyverse)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">library</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(kwb.flusshygiene)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#if (FALSE)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#### Laden von Testdaten ###################</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  rivers &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">c</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;havel&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  river &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> &quot;havel&quot;</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#river_paths &lt;- kwb.flusshygiene::get_paths()[paste0(rivers, &quot;data&quot;)]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  river_paths &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">havel =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;Y:/SUW_Department/Projects/FLUSSHYGIENE/Data-Work packages/Daten/Daten_TestPackage_Berlin/Havel/DATA_preprocessed_csv&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  river_paths &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">havel =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;/Users/heiko.langer/Masterarbeit_lokal/Data_preprocess/Daten_TestPackage_Berlin/Havel/DATA_preprocessed_csv&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  river_data &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">lapply</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_paths, kwb.flusshygiene</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">import_riverdata)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  river &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> &quot;havel&quot;</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_data) &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">rivers</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  calc_t &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">datalist=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">river_data</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">havel, onlysummer) {</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#heiko</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#datalist&lt;- river_data1$havel</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    phy_data &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">datalist[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">] </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># Entfernung der Hygienedaten</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(onlysummer</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">T){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      hyg_df &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">subset</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(datalist[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]],</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">subset =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> lubridate</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">month</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(datum) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%in%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">5</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">:</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">9</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># Filtern nach Sommer, warum hier 5:9 und beim anderen 4:9?</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      data_summer &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">lapply</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(phy_data, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        df &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">subset</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">subset =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> lubridate</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">month</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(datum) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%in%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">4</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">:</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">9</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">) </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      )</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># z_standardize &lt;- function (x) {</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#   y = (x - mean(x, na.rm=T))/sd(x, na.rm=T)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    log_transorm_rain &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df) { </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#log transforming rain data</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">for</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (site </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">in</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df)[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]) { </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># every col gets treatment</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        df2 &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">subset</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">select =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">c</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;datum&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, site))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">grepl</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;^r_.*&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,site)) { </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># rain gets log-transformed and 1/sigma2</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">          df2[[site]] &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">log</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df2[[site]]</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># df2[[site]] &lt;- df2[[site]]/sd(df2[[site]], na.rm=T)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        } </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#else {</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#   df[[site]] &lt;- z_standardize(df2[[site]]) # standardize</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        df[[site]] &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">df2[[site]]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">return</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    data_t &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">lapply</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(data_summer, log_transorm_rain)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    result &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">append</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(hyg_df), data_t)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(result) &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(datalist)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">return</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(result)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">### Anwenden von calc_t auf Inputliste</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  river_data_ts &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">lapply</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_data, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_list){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    river_ts &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">calc_t</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_list, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">onlysummer =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> T) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># use function</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    add_meancol &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (df) { </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># for rain and i #edit: + ka #2ndedit: + q</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      prefix &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">unique</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sub</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;([a-z])_.*&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="CharTok" /></w:rPr><w:t xml:space="preserve">\\</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">1&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df)[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">for</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (pre </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">in</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> prefix) {</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        df2 &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">dplyr</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">select</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df, dplyr</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">starts_with</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(pre))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        df[,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">paste0</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(pre,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;_mean&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)] &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">rowMeans</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df2, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">na.rm=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">T)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">return</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    add_sumcol &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (df) { </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># originally for ka, but not used</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      prefix &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">unique</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sub</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;([a-z])_.*&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="CharTok" /></w:rPr><w:t xml:space="preserve">\\</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">1&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df)[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&gt;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        df[,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">paste0</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(prefix,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;_sum&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)] &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">rowSums</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df[,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">], </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">na.rm=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">T)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">return</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    q_pos &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">grep</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;^q&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_ts)[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">])</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(q_pos) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      river_ts[[q_pos]] &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">add_meancol</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_ts[[q_pos]])</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    ka_pos &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">grep</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;^ka&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_ts)[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">])</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(ka_pos) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      river_ts[[ka_pos]] &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">add_meancol</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_ts[[ka_pos]])</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    i_pos &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">grep</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;^i&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_ts)[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">])</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(i_pos) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      river_ts[[i_pos]] &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">add_meancol</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_ts[[i_pos]])</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    r_pos &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">grep</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;^r&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_ts)[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">])</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    river_ts[[r_pos]] &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">add_meancol</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_ts[[r_pos]])</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">return</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_ts)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  })</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">rm</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river_data,calc_t)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  river =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> &quot;havel&quot;</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  pattern =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> &quot;(i_mean|q_mean_mean|r_mean_mean|ka_mean_mean)&quot;</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  riverdata &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">river_data_ts[[river]]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># prepare variables out of all cominations (given by pattern)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># variables for interaction get replaced by q_new (remove q_old)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  vars1 &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(riverdata[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">] </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">unroll_physical_data</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">() </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">              </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">              </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">lapply</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(names) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">unlist</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">() </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">unique</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">())[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  vars2 &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">vars1[stringr</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">str_detect</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(vars1, pattern)]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># prepare formulas</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  data &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">process_model_riverdata</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(riverdata, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">c</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;log_e.coli&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, vars2)) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">dplyr</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">select</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">datum)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  data &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">na.omit</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(data)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  data &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">data </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">filter</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(log_e.coli </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&gt;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">log10</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">15</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#why-heiko?</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#Definition of models</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># Definition of null and full models</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#stepwise models</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  null &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">lm</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(log_e.coli </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">~</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">data =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> data) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#model with only 1 variable</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  full &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">lm</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(log_e.coli </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">~</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">.</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">^</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">data =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> data)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#heiko models</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">} </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  {</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#heiko</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    {</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      get_coef_1se_cv &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        tmp_coeffs &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">coef</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">s =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;lambda.1se&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        a &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">data.frame</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">name =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> tmp_coeffs</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">@</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">Dimnames[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]][tmp_coeffs</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">@</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">i </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">], </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">coefficient =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> tmp_coeffs</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">@</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">x)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">return</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(a)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      get_coef_min_cv &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        tmp_coeffs &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">coef</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">s =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;lambda.min&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        a &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">data.frame</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">name =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> tmp_coeffs</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">@</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">Dimnames[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]][tmp_coeffs</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">@</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">i </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">], </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">coefficient =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> tmp_coeffs</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">@</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">x)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">return</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(a)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      get_coef_fixed_lambda &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df,lambda){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        tmp_coeffs &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">coef</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">s =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> lambda)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        a &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">data.frame</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">name =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> tmp_coeffs</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">@</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">Dimnames[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]][tmp_coeffs</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">@</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">i </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">], </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">coefficient =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> tmp_coeffs</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">@</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">x)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">return</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(a)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    get_formula_variable_names &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(formula_a,df){ </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      mf &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">model.frame</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(formula_a, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">data=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">df)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      mt &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">attr</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(mf, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;terms&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      predvarnames &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">attr</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(mt, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;term.labels&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      predvarnames</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#lasso</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#build/integrate here into folds to train with same cross validation</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fold1&lt;-train_rows[[1]]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#training_heiko&lt;-data[fold1,]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    part1&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(data)[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    form&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">formula</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">paste</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(part1,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot; ~ (.)^2&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_formula_variable_names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(form,data)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#training_heiko_features &lt;- (training_heiko%&gt;% select(-log_e.coli))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#sparse.model.matrix(form, training_heiko)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#form &lt;- log_e.coli ~ (.)ˆ2</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#training_heiko_features_matrix &lt;- (data.frame.2.sparseMatrix(training_heiko_features))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    train_sparse &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sparse.model.matrix</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(form, data) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#data must be dataframe</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#train_sparse &lt;- sparse.model.matrix(training_heiko$log_e.coli~(.)ˆ2, training_heiko[,3:ncol(training_heiko)]) #data must be dataframe</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#form &lt;- Y ~ (x + y + z)^2</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#testing_heiko&lt;-data[-fold1,]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">   </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># test_sparse &lt;- sparse.model.matrix(testing_heiko$log_e.coli~., testing_heiko[,3:ncol(testing_heiko)]) #data must be dataframe</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">set.seed</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">4</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    {        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    fit_lasso_base &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">glmnet</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(train_sparse, data</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">log_e.coli , </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">na.rm =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">T, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">standardize =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> F, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">alpha =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">relax =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> F)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    fit_lasso_base_cross &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">cv.glmnet</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(train_sparse, data</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">log_e.coli,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">type.measure=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;mse&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">alpha=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">family=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;gaussian&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">nfolds =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">3</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">standardize =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> F,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">relax =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> F)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#--&gt; alpha =1:  lasso regressio</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    fit_lasso_base_stand &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">glmnet</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(train_sparse, data</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">log_e.coli , </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">na.rm =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">T, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">standardize =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> T, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">alpha =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">relax =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> F)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    fit_lasso_base_cross_stand &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">cv.glmnet</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(train_sparse, data</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">log_e.coli,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">type.measure=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;mse&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">alpha=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">family=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;gaussian&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">nfolds =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">3</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">standardize =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> T,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">relax =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> F)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#--&gt; alpha =1:  lasso regressio</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#par(mfrow=c(2,2))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#plot(fit_lasso_base, xvar=&quot;lambda&quot;, label = T, main = &quot;lasso_base&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#plot(fit_lasso_base_cross,main=&quot;LASSO&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#plot(fit_lasso_base_stand, xvar=&quot;lambda&quot;, label = T, main = &quot;lasso_base_stand&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#plot(fit_lasso_base_cross_stand,main=&quot;LASSO&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#plot(fit_elnet_base, xvar=&quot;lambda&quot;, label = T, main = &quot;elnet_base&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#plot(fit_elnet_base_cross,main=&quot;elnet&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#plot(fit_elnet_base_stand, xvar=&quot;lambda&quot;, label = T, main = &quot;elnet_base_stand&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#plot(fit_elnet_base_cross_stand,main=&quot;elnet&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    get_feature_selection_coeficient_names_as_formular_1se &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(algorithm_list){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fit_lasso_base_cross</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#algorithm_list&lt;-fit_lasso_base_cross</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      coef_1se&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_coef_1se_cv</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(algorithm_list)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">dim</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(coef_1se)[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">print</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;only intercept. nothing to model&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      }</w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">else</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">{</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">            coef_name_lambda_1se&lt;-coef_1se</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">name[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#a&lt;-str(&quot;&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      coefficients&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">paste</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(coef_name_lambda_1se, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">collapse =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot; + &quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> )</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      formel&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">paste</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;log_e.coli ~ &quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, coefficients)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      formel</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      formula_from_selector&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">formula</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(formel)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">return</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(formula_from_selector)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    get_feature_selection_coeficient_names_as_formular_lambda_min &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(algorithm_list){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#algorithm_list&lt;-fit_lasso_base_cross</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      coef_lambda_min&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_coef_min_cv</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(algorithm_list)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      coef_name_lambda_min&lt;-coef_lambda_min</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">name[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#a&lt;-str(&quot;&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      coefficients&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">paste</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(coef_name_lambda_min, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">collapse =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot; + &quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> )</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      formel&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">paste</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;log_e.coli ~ &quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, coefficients)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      formula_from_selector&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">formula</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(formel)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">return</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(formula_from_selector)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    coef_1se_fit_lasso_base_cross&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_coef_1se_cv</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (fit_lasso_base_cross)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    coef_1se_fit_lasso_base_cross_stand&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_coef_1se_cv</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (fit_lasso_base_cross_stand)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    coef_lambda_min_fit_lasso_base_cross&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_coef_min_cv</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (fit_lasso_base_cross)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    coef_lambda_min_fit_lasso_base_cross_stand&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_coef_min_cv</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (fit_lasso_base_cross_stand)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># add_new_formulas_to_list_if_exists &lt;- function(coef_list){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#    if(exists(&quot;coef_1se_fit_lasso_base_cross&quot;)== TRUE){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#     idx &lt;- length(list_lasso)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#    idx &lt;- idx+1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#    list_lasso[[idx]] &lt;-coef_1se_fit_lasso_base_cross</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#  }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#}</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    list_lasso &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    coef_1se_fit_lasso_base_cross               &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_feature_selection_coeficient_names_as_formular_1se</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fit_lasso_base_cross)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">exists</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;coef_1se_fit_lasso_base_cross&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OtherTok" /></w:rPr><w:t xml:space="preserve">TRUE</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      idx &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(list_lasso)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      idx &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">idx</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      list_lasso[[idx]] &lt;-coef_1se_fit_lasso_base_cross</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    coef_1se_fit_lasso_base_cross_stand         &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_feature_selection_coeficient_names_as_formular_1se</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fit_lasso_base_cross_stand)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">exists</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;coef_1se_fit_lasso_base_cross_stand&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OtherTok" /></w:rPr><w:t xml:space="preserve">TRUE</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      idx &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(list_lasso)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      idx &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">idx</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      list_lasso[[idx]] &lt;-coef_1se_fit_lasso_base_cross_stand</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    coef_lambda_min_fit_lasso_base_cross        &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_feature_selection_coeficient_names_as_formular_lambda_min</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fit_lasso_base_cross)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">exists</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;coef_lambda_min_fit_lasso_base_cross&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OtherTok" /></w:rPr><w:t xml:space="preserve">TRUE</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      idx &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(list_lasso)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      idx &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">idx</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      list_lasso[[idx]] &lt;-coef_lambda_min_fit_lasso_base_cross</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    coef_lambda_min_fit_lasso_base_cross_stand  &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_feature_selection_coeficient_names_as_formular_lambda_min</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fit_lasso_base_cross_stand)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">exists</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;coef_lambda_min_fit_lasso_base_cross_stand&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OtherTok" /></w:rPr><w:t xml:space="preserve">TRUE</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      idx &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(list_lasso)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      idx &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">idx</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      list_lasso[[idx]] &lt;-coef_lambda_min_fit_lasso_base_cross_stand</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#check if all 4 coefficients exist and remove intercepts</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    idx &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">0</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">for</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(element </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">in</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> list_lasso){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      idx&lt;-idx</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">typeof</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(element)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">!=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;language&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        list_lasso &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">list_lasso[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">idx]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">print</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;f&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    list_lasso</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#print(paste(length(list_lasso),&quot; new models added&quot;)) </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    model_lsit&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#list_lasso</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#builded linear model</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">lm</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(list_lasso[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]], </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">data =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> data)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">lm</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(list_lasso[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]],</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">data=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">data)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">3</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">lm</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(list_lasso[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">3</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]],</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">data=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">data)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">4</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">lm</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(list_lasso[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">4</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]],</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">data=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">data)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    list_heiko_lm &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    list_heiko_lm[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]]&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    list_heiko_lm[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]]&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    list_heiko_lm[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">3</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]]&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">3</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    list_heiko_lm[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">4</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]]&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">4</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#for(form in list_lasso){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">     </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># heiko_lm &lt;- lm(form, data = data)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#  heiko_lm&lt;-list(heiko_lm)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">     </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># append(heiko_lm,model_lsit)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#  }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#heiko_lm&lt;- lm(formula_heiko_1, data = data)   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#nicht mehr benötigt  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#### Anwenden der Hauptfunktion ###################</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  stepwise &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> (river, pattern, data, null, full ){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># Definition maximum number of steps</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    nsteps &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">5</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#ifelse(round(nrow(data)/10) &lt; 10, round(nrow(data)/10), 5 )</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    selection &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    fmla &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># Creating list of candidate models with 1 ...n predictors </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#split up this piece in stpe and new algorithms/formulars</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">for</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(i </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">in</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">:</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">nsteps){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      selection[[i]] &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">step</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(null, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">data =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> data,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                             </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                             </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">direction =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;forward&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                             </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                             </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">lower=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">null, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">upper=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">full), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">steps =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> i, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">trace=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OtherTok" /></w:rPr><w:t xml:space="preserve">FALSE</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      fmla[[i]] &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">as.list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(selection[[i]]</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">call)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">formula</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#heiko_add_formular to fmla list function function</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#selection[[6]] &lt;- heiko_lm</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fmla[[6]] &lt;- as.list(selection[[6]]$call)$formula</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    step_returns &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fmla, selection)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">return</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(step_returns)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># order of pattern, q_old and q_new is important!</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fb &lt;- stepwise(river = river, pattern = &quot;(i_mean|q_mean_mean|r_mean_mean|ka_mean_mean)&quot;, data,null, full)#,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  step_returns &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">stepwise</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">river =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> river, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">pattern =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;(i_mean|q_mean_mean|r_mean_mean|ka_mean_mean)&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, data,null, full)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fmla &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">step_returns[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  selection &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">step_returns[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#adding new linear models, featureselection with lasso/elnet</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#selection&lt;-append(selection, list(heiko_lm_1,heiko_lm_2,heiko_lm_3,heiko_lm_4))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  selection&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">append</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(selection, list_heiko_lm)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fb&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">selection  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fb[6] &lt;- list(heiko_lm)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#selection[6] &lt;- list(heiko_lm)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#selection</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fb</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fmla_heiko_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">eval</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">call</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">formula)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fmla_heiko_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">eval</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">call</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">formula)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fmla_heiko_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">3</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">eval</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">3</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">call</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">formula)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fmla_heiko_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">4</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">eval</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(heiko_lm_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">4</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">call</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">formula)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fmla_heiko &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">list</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fmla_heiko[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]]&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">fmla_heiko_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fmla_heiko[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]]&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">fmla_heiko_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fmla_heiko[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">3</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]]&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">fmla_heiko_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">3</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fmla_heiko[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">4</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]]&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">fmla_heiko_</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">4</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># as.list(selection[[6]]$call)$formula</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fmla&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">append</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fmla, fmla_heiko)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fmla</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">class</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fmla[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fmla)]]) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">!=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;formula&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">print</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;new element is no formula!!&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#add my models here</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#q_old = &quot;q_cochem&quot;,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#q_new = &quot;q_cochem_abs_1&quot;)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fb) &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sprintf</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">paste0</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;model_%02d&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">seq_along</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">:</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fb)))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">################ Validation ########################</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># calculate statistical tests for residuals: Normality and s2 = const</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># shapiro-wilk test and breusch-pagan test</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  get_stat_tests &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(model) {</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">c</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">N =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">shapiro.test</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(model</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">residuals)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">p.value, lmtest</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">bptest</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(model)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">p.value,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">R2 =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">summary</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(model)[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;adj.r.squared&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">]], </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">n_obs =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(model</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">residuals))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># Eliminieren von modelled die doppelt vorkommen, da forward selection früher</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fertig als n steps</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#heiko add fb beforehand to this</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fb</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  unique_index &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">unique</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fb))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  fb &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">fb[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">:</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">unique_index]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># testing for classical statistical model assumtions, normality of residuals and</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># heteroskelasdicity</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  river_stat_tests &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sapply</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fb, get_stat_tests)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">t</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">() </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">dplyr</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">as_tibble</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">rownames =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;model&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">dplyr</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">bind_rows</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">.id =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;river&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">dplyr</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">mutate</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">stat_correct =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> N </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&gt;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">.05</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&amp;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">BP </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&gt;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">.05</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve"># creating list of independent training rows</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#-test/train split</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#weirde zeile, setze alle stat tests auf 0</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">in95 &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">below95 &lt;-river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">below90 &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">in50 &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">0</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  train_rows &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">caret</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">createFolds</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">:</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">nrow</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fb[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">paste0</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;model_01&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)]]</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model),</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                                   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                                   </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">k =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">5</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">list =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> T, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">returnTrain =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> T)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">class</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fmla[[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fmla)]]) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">!=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;formula&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">print</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;new element is no formula!!&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  test_beta &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">function</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(true, false, percentile){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">if</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">( </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">pbeta</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">q =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> percentile, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">shape1 =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> true </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">shape2 =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> false </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&gt;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">0.05</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OtherTok" /></w:rPr><w:t xml:space="preserve">TRUE</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">}</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">else</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">{</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OtherTok" /></w:rPr><w:t xml:space="preserve">FALSE</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">}</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  }</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fmla) &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sprintf</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">paste0</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(river,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;model_%02d&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">seq_along</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">:</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">length</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fb)))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  counter&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">0</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fb&lt;-fb[-6]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#names(fb)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">}</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">for</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(i </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">in</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fb)){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  counter&lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">counter</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">       </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#i=&quot;havelmodel_01&quot;</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">for</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(j </w:t></w:r><w:r><w:rPr><w:rStyle w:val="ControlFlowTok" /></w:rPr><w:t xml:space="preserve">in</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">:</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">5</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">){</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      counter &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">counter</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">       </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#   j=1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        training &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">as.data.frame</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fb[[i]]</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model)[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">c</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(train_rows[[j]]),]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#training &lt;- as.data.frame(fb[[6]]$model)[c(train_rows[[1]]),]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        test &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">as.data.frame</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fb[[i]]</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model)[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">c</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(train_rows[[j]]),]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#test &lt;- as.data.frame(fb[[6]]$model)[-c(train_rows[[1]]),]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#formel&lt;-formula(formula_heiko_1)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fmla[6]&lt;- list(formel)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        fit &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">rstanarm</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">stan_glm</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fmla[[i]], </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">data =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> training, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">refresh=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">0</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fitting #suppress print out with refresh =0</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fit &lt;- rstanarm::stan_glm(fmla[[1]], data = training) #fitting</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">       </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        df &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">apply</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(rstanarm</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">posterior_predict</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fit, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">newdata =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> test), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, quantile, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#predicting</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">probs =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">c</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">0.025</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">0.25</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">0.75</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">0.9</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">0.95</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">0.975</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">t</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">() </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">as.data.frame</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">() </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">dplyr</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">mutate</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">log_e.coli =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> test</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">log_e.coli, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#evaluating ther model has to be classified correctly with every single test train split</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#--&gt; here 5 different splits, if all validations correct than everywhere ==5</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">below95 =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> log_e.coli </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&lt;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> `</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">95%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">`</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">below90 =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> log_e.coli </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&lt;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> `</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">90%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">`</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">within95 =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> log_e.coli </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&lt;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> `</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">97.5%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">`</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&amp;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">log_e.coli </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&gt;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> `</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">2.5%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">`</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">within50 =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> log_e.coli </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&lt;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> `</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">75%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">`</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&amp;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">log_e.coli </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&gt;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> `</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">25%</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">`</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">          )</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#validation step if allpercentile categories are set to 1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">in95[river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">i] &lt;-</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">in95[river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">i] </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">test_beta</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">true =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sum</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">within95), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">false =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sum</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">!</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">df</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">within95), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">percentile =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">.95</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> )</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">below95[river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">i] &lt;-</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">below95[river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">i] </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">test_beta</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">true =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sum</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">below95), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">false =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sum</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">!</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">df</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">below95), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">percentile =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">.95</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> )</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">below90[river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">i] &lt;-</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">below90[river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">i] </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">test_beta</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">true =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sum</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">below90), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">false =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sum</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">!</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">df</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">below90), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">percentile =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">.90</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> )</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">in50[river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">i] &lt;-</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">in50[river_stat_tests</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">i] </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">+</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">          </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">test_beta</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">true =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sum</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(df</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">within50), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">false =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">sum</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">!</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">df</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">within50), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="FloatTok" /></w:rPr><w:t xml:space="preserve">.5</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">        </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      } </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">      </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  } </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#fmla</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">}  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">}  </w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## Attaching package: &#39;dplyr&#39;</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## The following objects are masked from &#39;package:stats&#39;:</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##     filter, lag</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## The following objects are masked from &#39;package:base&#39;:</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##     intersect, setdiff, setequal, union</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## Loading required package: Matrix</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## Loaded glmnet 4.0</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## Attaching package: &#39;purrr&#39;</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## The following object is masked from &#39;package:magrittr&#39;:</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##     set_names</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## ── Attaching packages ───────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## ✓ ggplot2 3.3.1     ✓ readr   1.3.1</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## ✓ tibble  3.0.1     ✓ stringr 1.4.0</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## ✓ tidyr   1.1.0     ✓ forcats 0.5.0</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## ── Conflicts ──────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## x tidyr::expand()    masks Matrix::expand()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## x tidyr::extract()   masks magrittr::extract()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## x dplyr::filter()    masks stats::filter()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## x dplyr::lag()       masks stats::lag()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## x tidyr::pack()      masks Matrix::pack()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## x purrr::set_names() masks magrittr::set_names()</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## x tidyr::unpack()    masks Matrix::unpack()</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## Type &#39;citation(&quot;pROC&quot;)&#39; for a citation.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## Attaching package: &#39;pROC&#39;</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## The following objects are masked from &#39;package:stats&#39;:</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##     cov, smooth, var</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## Attaching package: &#39;kwb.flusshygiene&#39;</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## The following objects are masked from &#39;package:fhpredict&#39;:</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##     build_model, predict_quality</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  sorted_modellist &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">river_stat_tests </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">filter</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">( below95 </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">5</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&amp;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">below90 </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">==</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">5</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">&amp;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">in95) </w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">%&gt;%</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">dplyr</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">::</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">arrange</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">desc</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(in50), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">desc</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(R2))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#river_stat_tests</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#sorted_modellist</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  best_valid_model_stats &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">sorted_modellist[</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">1</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  best_valid_model &lt;-</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">fb[[best_valid_model_stats</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">model]]</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#coef(best_valid_model)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#refit best model</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#stanfit &lt;- rstanarm::stan_glm(fmla[[best_valid_model_stats$model]],</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                                </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">   </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#                             data = best_valid_model$model, refresh=0)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#brmsfit &lt;- brms::brm(fmla[[best_valid_model_stats$model]],</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">                       </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#                      data = best_valid_model$model, iter = 10000)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">  </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#return(list(sorted_modellist = sorted_modellist,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">              </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">   </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#           best_model = best_valid_model,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">              </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#          stanfit = stanfit,</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">              </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">     </w:t></w:r><w:r><w:rPr><w:rStyle w:val="CommentTok" /></w:rPr><w:t xml:space="preserve">#         brmsfit = brmsfit))</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">The used data is from river</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">‘</w:t></w:r><w:r><w:t xml:space="preserve">Havel</w:t></w:r><w:r><w:t xml:space="preserve">’</w:t></w:r><w:r><w:t xml:space="preserve">:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">“</w:t></w:r><w:r><w:t xml:space="preserve">/Data_preprocess/Daten_TestPackage_Berlin/Havel/DATA_preprocessed_csv</w:t></w:r><w:r><w:t xml:space="preserve">”</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">It is taken from the data folder provided by Wolfgang and has the following structure</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">glimpse</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(data)</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## Rows: 36</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## Columns: 31</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ log_e.coli         &lt;dbl&gt; 2.100371, 2.428135, 2.252853, 2.838849, 1.662758, …</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ ka_mean_mean_12    &lt;dbl&gt; 38.0145, 69.7390, 0.0000, 109.7215, 32.4950, 36.65…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ ka_mean_mean_123   &lt;dbl&gt; 25.34300000, 108.61533333, 0.00000000, 85.48100000…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ ka_mean_mean_1234  &lt;dbl&gt; 19.00725, 86.94825, 0.00000, 97.09825, 19.73725, 2…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ ka_mean_mean_12345 &lt;dbl&gt; 15.2058, 79.3838, 13.3450, 84.9316, 17.4996, 18.48…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ ka_mean_mean_2345  &lt;dbl&gt; 17.36950, 70.51750, 16.68125, 74.91325, 5.62700, 1…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ ka_mean_mean_345   &lt;dbl&gt; 0.000000, 85.813667, 22.241667, 68.405000, 7.50266…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ ka_mean_mean_45    &lt;dbl&gt; 0.0000, 35.5365, 33.3625, 84.1075, 11.2540, 9.5690…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ ka_mean_mean_234   &lt;dbl&gt; 23.1593333, 77.6480000, 0.0000000, 87.7960000, 4.6…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ ka_mean_mean_23    &lt;dbl&gt; 34.7390, 105.4985, 0.0000, 65.7190, 0.0000, 28.857…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ ka_mean_mean_34    &lt;dbl&gt; 0.0000, 104.1575, 0.0000, 84.4750, 6.9795, 5.3530,…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ q_mean_mean_12     &lt;dbl&gt; 61.65, 75.15, 68.30, 80.30, 66.95, 25.85, 37.25, 3…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ q_mean_mean_123    &lt;dbl&gt; 61.43333, 75.16667, 70.56667, 78.16667, 65.93333, …</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ q_mean_mean_1234   &lt;dbl&gt; 62.175, 68.925, 72.650, 78.325, 65.125, 27.325, 30…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ q_mean_mean_12345  &lt;dbl&gt; 61.48, 64.44, 74.76, 76.68, 64.82, 25.50, 27.00, 3…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ q_mean_mean_2345   &lt;dbl&gt; 61.325, 61.900, 76.525, 74.650, 63.975, 25.625, 23…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ q_mean_mean_345    &lt;dbl&gt; 61.36667, 57.30000, 79.06667, 74.26667, 63.40000, …</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ q_mean_mean_45     &lt;dbl&gt; 61.55, 48.35, 81.05, 74.45, 63.15, 25.35, 16.85, 3…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ q_mean_mean_234    &lt;dbl&gt; 62.20000, 67.03333, 74.30000, 76.16667, 64.10000, …</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ q_mean_mean_23     &lt;dbl&gt; 61.10, 75.45, 72.00, 74.85, 64.80, 25.90, 29.70, 4…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ q_mean_mean_34     &lt;dbl&gt; 62.70, 62.70, 77.00, 76.35, 63.30, 28.80, 23.05, 4…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ r_mean_mean_12     &lt;dbl&gt; 1.15234521, 1.34171239, 0.04126964, 1.93422257, 0.…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ r_mean_mean_123    &lt;dbl&gt; 0.82315166, 1.95004080, 0.06128739, 1.41172257, 0.…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ r_mean_mean_1234   &lt;dbl&gt; 0.6435257, 2.1261437, 0.3237925, 1.6186162, 0.5993…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ r_mean_mean_12345  &lt;dbl&gt; 0.5262331, 1.7113038, 0.5347389, 1.4190294, 0.5910…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ r_mean_mean_2345   &lt;dbl&gt; 0.2533034, 1.6019403, 0.6573695, 1.1881228, 0.4187…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ r_mean_mean_345    &lt;dbl&gt; 0.1088251, 1.9576981, 0.8637185, 1.0755673, 0.5476…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ r_mean_mean_45     &lt;dbl&gt; 0.08085530, 1.35319831, 1.24491623, 1.42998969, 0.…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ r_mean_mean_234    &lt;dbl&gt; 0.3187169, 2.1186057, 0.4169844, 1.3772697, 0.3723…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ r_mean_mean_23     &lt;dbl&gt; 0.42575152, 1.85068227, 0.06982273, 0.94625589, 0.…</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## $ r_mean_mean_34     &lt;dbl&gt; 0.1347061, 2.9105750, 0.6063153, 1.3030099, 0.5425…</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">The prebuild list of 31 averaged variables/features are increased through interactions between each other. This is done by building all interaction formulars with</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">“</w:t></w:r><w:r><w:t xml:space="preserve">formula(paste(part1,</w:t></w:r><w:r><w:t xml:space="preserve">”</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">~ (.)^2</w:t></w:r><w:r><w:t xml:space="preserve">“</w:t></w:r><w:r><w:t xml:space="preserve">)</w:t></w:r><w:r><w:t xml:space="preserve">”</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">So every feature besides e.coli will be multiplied with every other feature which leads to 466 features from which the Lasso-algorithms are selecting the most important.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">here is an insight of the last 50 formulas</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">tail</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_formula_variable_names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(form,data), </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">50</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##  [1] &quot;q_mean_mean_34:r_mean_mean_345&quot;     &quot;q_mean_mean_34:r_mean_mean_45&quot;     </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##  [3] &quot;q_mean_mean_34:r_mean_mean_234&quot;     &quot;q_mean_mean_34:r_mean_mean_23&quot;     </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##  [5] &quot;q_mean_mean_34:r_mean_mean_34&quot;      &quot;r_mean_mean_12:r_mean_mean_123&quot;    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##  [7] &quot;r_mean_mean_12:r_mean_mean_1234&quot;    &quot;r_mean_mean_12:r_mean_mean_12345&quot;  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##  [9] &quot;r_mean_mean_12:r_mean_mean_2345&quot;    &quot;r_mean_mean_12:r_mean_mean_345&quot;    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [11] &quot;r_mean_mean_12:r_mean_mean_45&quot;      &quot;r_mean_mean_12:r_mean_mean_234&quot;    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [13] &quot;r_mean_mean_12:r_mean_mean_23&quot;      &quot;r_mean_mean_12:r_mean_mean_34&quot;     </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [15] &quot;r_mean_mean_123:r_mean_mean_1234&quot;   &quot;r_mean_mean_123:r_mean_mean_12345&quot; </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [17] &quot;r_mean_mean_123:r_mean_mean_2345&quot;   &quot;r_mean_mean_123:r_mean_mean_345&quot;   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [19] &quot;r_mean_mean_123:r_mean_mean_45&quot;     &quot;r_mean_mean_123:r_mean_mean_234&quot;   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [21] &quot;r_mean_mean_123:r_mean_mean_23&quot;     &quot;r_mean_mean_123:r_mean_mean_34&quot;    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [23] &quot;r_mean_mean_1234:r_mean_mean_12345&quot; &quot;r_mean_mean_1234:r_mean_mean_2345&quot; </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [25] &quot;r_mean_mean_1234:r_mean_mean_345&quot;   &quot;r_mean_mean_1234:r_mean_mean_45&quot;   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [27] &quot;r_mean_mean_1234:r_mean_mean_234&quot;   &quot;r_mean_mean_1234:r_mean_mean_23&quot;   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [29] &quot;r_mean_mean_1234:r_mean_mean_34&quot;    &quot;r_mean_mean_12345:r_mean_mean_2345&quot;</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [31] &quot;r_mean_mean_12345:r_mean_mean_345&quot;  &quot;r_mean_mean_12345:r_mean_mean_45&quot;  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [33] &quot;r_mean_mean_12345:r_mean_mean_234&quot;  &quot;r_mean_mean_12345:r_mean_mean_23&quot;  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [35] &quot;r_mean_mean_12345:r_mean_mean_34&quot;   &quot;r_mean_mean_2345:r_mean_mean_345&quot;  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [37] &quot;r_mean_mean_2345:r_mean_mean_45&quot;    &quot;r_mean_mean_2345:r_mean_mean_234&quot;  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [39] &quot;r_mean_mean_2345:r_mean_mean_23&quot;    &quot;r_mean_mean_2345:r_mean_mean_34&quot;   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [41] &quot;r_mean_mean_345:r_mean_mean_45&quot;     &quot;r_mean_mean_345:r_mean_mean_234&quot;   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [43] &quot;r_mean_mean_345:r_mean_mean_23&quot;     &quot;r_mean_mean_345:r_mean_mean_34&quot;    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [45] &quot;r_mean_mean_45:r_mean_mean_234&quot;     &quot;r_mean_mean_45:r_mean_mean_23&quot;     </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [47] &quot;r_mean_mean_45:r_mean_mean_34&quot;      &quot;r_mean_mean_234:r_mean_mean_23&quot;    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [49] &quot;r_mean_mean_234:r_mean_mean_34&quot;     &quot;r_mean_mean_23:r_mean_mean_34&quot;</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">The features are getting selected through the lasso algorithm with cross validation without (1.row) or with (2.row) internal standardization of the features</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">The following 4 graphs show the the number of selected features (upper sclae) dependend on log lambda (lower scale)</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">The left dotted line shows the lambda with the minimal MSE - identified throug cross-validation</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">The right dotted line shows the lambda 1 standard deviation away from the with the minimal MSE - identified throug cross-validation (shall give a better generalization than minimum mse)</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">par</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">mfrow=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">c</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DecValTok" /></w:rPr><w:t xml:space="preserve">2</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">))</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">plot</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fit_lasso_base, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">xvar=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;lambda&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">label =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> T, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">main =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;lasso_base&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">plot</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fit_lasso_base_cross,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">main=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;LASSO&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">plot</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fit_lasso_base_stand, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">xvar=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;lambda&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">label =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> T, </w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">main =</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve"> </w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;lasso_base_stand&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">    </w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">plot</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fit_lasso_base_cross_stand,</w:t></w:r><w:r><w:rPr><w:rStyle w:val="DataTypeTok" /></w:rPr><w:t xml:space="preserve">main=</w:t></w:r><w:r><w:rPr><w:rStyle w:val="StringTok" /></w:rPr><w:t xml:space="preserve">&quot;LASSO&quot;</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">)</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:drawing><wp:inline><wp:extent cx="5334000" cy="4267200" /><wp:effectExtent b="0" l="0" r="0" t="0" /><wp:docPr descr="" title="" id="1" name="Picture" /><a:graphic><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic><pic:nvPicPr><pic:cNvPr descr="lasso_first_results_havel_files/figure-docx/unnamed-chunk-4-1.png" id="0" name="Picture" /><pic:cNvPicPr><a:picLocks noChangeArrowheads="1" noChangeAspect="1" /></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="rId20" /><a:stretch><a:fillRect /></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0" /><a:ext cx="5334000" cy="4267200" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom><a:noFill /><a:ln w="9525"><a:noFill /><a:headEnd /><a:tailEnd /></a:ln></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">lambda 1se for lasso base cross</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_coef_1se_cv</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fit_lasso_base_cross)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">name</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [1] &quot;(Intercept)&quot;                    &quot;q_mean_mean_123:q_mean_mean_23&quot;</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">lambda 1se for lasso base cross standardized</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">get_coef_1se_cv</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(fit_lasso_base_cross_stand)</w:t></w:r><w:r><w:rPr><w:rStyle w:val="OperatorTok" /></w:rPr><w:t xml:space="preserve">$</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">name</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [1] &quot;(Intercept)&quot;                      &quot;q_mean_mean_2345&quot;                </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [3] &quot;ka_mean_mean_12:ka_mean_mean_123&quot; &quot;ka_mean_mean_12:ka_mean_mean_34&quot; </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [5] &quot;q_mean_mean_12:r_mean_mean_12&quot;    &quot;q_mean_mean_45:r_mean_mean_12&quot;   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [7] &quot;q_mean_mean_45:r_mean_mean_12345&quot; &quot;q_mean_mean_45:r_mean_mean_45&quot;</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">9 different models were build in the very first code snippet:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">- 5 from stepwise regression, with 1-5 explanatory variables (choosen with Information Criterion)</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">- 4 Lasso based models:</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">from the two cross validated lasso fits: fit_lasso_base_cross and fit_lasso_base_cross_stand (with internal standardization of features) I used lambda min and lambda-1se to get 4 lasso based models with the following modelnumbers:</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">06: fit_lasso_base_cross lambda-1se</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">07: fit_lasso_base_cross_stand lambda-1se</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">08: fit_lasso_base_cross lambda-min</w:t></w:r><w:r><w:t xml:space="preserve"> </w:t></w:r><w:r><w:t xml:space="preserve">09: fit_lasso_base_cross_stand lambda-min</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">The 4 Lasso based models were than used in the posterior function for validation. If in50, below90, below95, and in 95 are all == 5 –&gt; the model is validated through the validation method from wolfgang.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">The best Model was chosen by further checking statistical correctness and sorting R2 in descending order.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">sorted_modellist </w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## # A tibble: 9 x 11</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##   river model       N     BP    R2 n_obs stat_correct  in50 below90 below95</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">##   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## 1 1     have… 5.69e-1 0.155  0.697    36 TRUE             5       5       5</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## 2 1     have… 7.56e-1 0.0807 0.681    36 TRUE             5       5       5</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## 3 1     have… 8.32e-2 0.391  0.654    36 TRUE             5       5       5</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## 4 1     have… 2.22e-2 0.365  0.636    36 FALSE            5       5       5</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## 5 1     have… 5.06e-4 0.514  0.591    36 FALSE            5       5       5</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## 6 1     have… 4.95e-2 0.0225 0.560    36 FALSE            5       5       5</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## 7 1     have… 1.60e-2 0.0524 0.423    36 FALSE            5       5       5</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## 8 1     have… 8.46e-2 0.153  0.503    36 TRUE             4       5       5</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## 9 1     have… 3.68e-2 0.0236 0.474    36 FALSE            4       5       5</w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## # … with 1 more variable: in95 &lt;dbl&gt;</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="FirstParagraph" /></w:pPr><w:r><w:t xml:space="preserve">Whats interesting is, that only the standardized models (07 &amp; 09) were able to beat the stepwise builded models with this evaluation method.</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="BodyText" /></w:pPr><w:r><w:t xml:space="preserve">Best Model here is havelmodel_09 with the following coefficients:</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">names</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(</w:t></w:r><w:r><w:rPr><w:rStyle w:val="KeywordTok" /></w:rPr><w:t xml:space="preserve">coef</w:t></w:r><w:r><w:rPr><w:rStyle w:val="NormalTok" /></w:rPr><w:t xml:space="preserve">(best_valid_model))</w:t></w:r></w:p><w:p><w:pPr><w:pStyle w:val="SourceCode" /></w:pPr><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [1] &quot;(Intercept)&quot;                      &quot;q_mean_mean_45&quot;                  </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [3] &quot;ka_mean_mean_12:ka_mean_mean_123&quot; &quot;ka_mean_mean_12:ka_mean_mean_34&quot; </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [5] &quot;q_mean_mean_12:r_mean_mean_12&quot;    &quot;q_mean_mean_45:r_mean_mean_12&quot;   </w:t></w:r><w:r><w:br w:type="textWrapping" /></w:r><w:r><w:rPr><w:rStyle w:val="VerbatimChar" /></w:rPr><w:t xml:space="preserve">## [7] &quot;q_mean_mean_45:r_mean_mean_1234&quot;  &quot;q_mean_mean_45:r_mean_mean_45&quot;</w:t></w:r></w:p><w:sectPr /></w:body></w:document>